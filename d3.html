<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Kiva stuff.</title>
<style type="text/css">
img {
height: 100px;
float: left;
}

svg {
  font-family: "Helvetica Neue", Helvetica;
}

.line {
fill: none;
stroke: #000;
stroke-width: 2px;
}

</style>
		<script src="http://code.jquery.com/jquery-1.10.2.js"></script>

		<script src="http://d3js.org/d3.v3.min.js"></script>
</head>
<body>

<h1> Kiva stuff.</h1>

<pre>
Reminder: Ctrl+Option+K to open the Javascript console on Mac Firefox.
DONE: Do not fetch Kiva data on every page reload.

</pre>
<button onClick='fetchAPIData();'>
	Fetch API Data
	</button>

Maybe it just needs an anchor.
<div id="images"></div>

Output list...
<div id='header'>
<ul id='output'>
</ul>

<p id='printout'>
Output paragraph...
</p>
</div>


<script>

console.log("console test");

	function writeToScreen( data, status ) {
		$( "#header p" ).append('Success: ' + status);
		$( "#header p" ).append('Data: ' + data);
		console.log(JSON.stringify(data));

		$.each( data.items, function( i, item ) {
			alert(item);
			$( "#header ul" ).append('<li>' + item + '</li>' );
			if ( i === 3 ) {
				return false;
}
});
};

	function fetchAPIData() {
		// alert("called fetchAPIData");
		var flickerAPI = "http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?";
		var kivaAPI = 'http://api.kivaws.org/v1/loans/575151.json';

		$.getJSON( kivaAPI ).done( writeToScreen );
	};


	$( document ).ready( function() {
		console.log("ready");
		// alert('Huzzah!');
		$(" button ").onClick = fetchAPIData;



	});

	var body = d3.select("body");
	var div = body.append("div");
	div.html("Hello world.");
	var data  = d3.range(33).map(next); 
	function next() {
	    return {
       time: ++t,
        value: v = ~~Math.max(10, Math.min(90, v + 10 * (Math.random() - .5)))
       };
	 }

	var svg = body.append("svg");


	var w = 20,
		h = 80;

	var x = d3.scale.linear()
			.domain([0,1])
			.range([0,2]);
	var y = d3.scale.linear()
			.domain([0,100])
			.rangeRound([0,h]);

	var chart = d3.select("body").append("svg")
		.attr("class", "chart")
		.attr("width", w * data.length - 1)
		.attr("height", h);

	chart.selectAll("rect")
		.data(data)
		.enter().append("rect")	
		   .attr("x", function(d, i) { return x(i) - .5; })
		        .attr("y", function(d) { return h - y(d.value) - .5; })
		        .attr("width", w)
		        .attr("height", function(d) { return y(d.value); });

</script>

<div class="chart">
</div>

</body>
</html>
